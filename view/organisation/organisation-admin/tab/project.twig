<h2>{{ translate("txt-project") }}</h2>

{% if organisation.affiliation.count() > 0 %}
    <table class="table table-hover table-striped">
        <thead>
        <tr>
            <th>{{ translate("txt-project") }}</th>
            <th>{{ translate("txt-partner") }}</th>
            <th>{{ translate("txt-branch") }}</th>
            <th>{{ translate("txt-project-status") }}</th>
            <th>{{ translate("txt-active") }}</th>
            <th>{{ translate("txt-technical-contact") }}</th>
        </tr>
        </thead>
        {% for affiliation in organisation.affiliation %}
            {% set projectService = projectServiceProxy(affiliation.project) %}
            <tr {% if projectService.project.contact.id == affiliation.contact.id %}class="success"
                {% endif %}{% if affiliation.dateEnd %}class="danger"{% endif %}>
                <td>{{ projectLink(projectService,'view-admin','name') }}
                    {{ projectLink(projectService,'view-community','icon') }}
                </td>
                <td>
                    {{ affiliationLink(affiliation,'view-admin','name') }}
                    {{ affiliationLink(affiliation,'view-community','icon') }}
                </td>
                <td>{{ affiliation.branch }}</td>
                <td>{{ projectService.parseStatus() }}</td>
                <td>{% if affiliation.dateEnd %}{{ translate("txt-deactivated-on-%s")|format(affiliation.dateEnd|date('d-m-Y')) }}{% else %}{{ translate("txt-yes") }}{% endif %}</td>
                <td>{{ contactLink(affiliation.contact,'view-admin') }} {% if projectService.project.contact.id == affiliation.contact.id %}({{ translate("txt-pl") }}){% endif %}</td>
            </tr>

        {% endfor %}
    </table>
{% else %}
    {{ ztbalert().info(translate("txt-%s-is-not-active-in-a-project"))|format(organisation)|raw }}
{% endif %}

{{ organisationLink(organisation,'add-affiliation','button') }}
